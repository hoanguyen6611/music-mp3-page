"use strict";(self.webpackChunkmusic_mp3_page=self.webpackChunkmusic_mp3_page||[]).push([[38],{3038:(X,f,s)=>{s.r(f),s.d(f,{AblumDetailModule:()=>R});var u=s(6895),v=s(9116),g=s(1293),t=s(4650),m=s(4280),h=s(8505),p=s(3900),S=s(8746),F=s(9646),L=s(5106),T=s(8689),A=s(9651),D=s(9383),C=s(5445);const I={IsLoadingDetail:!1,Album:{id:"",name:"",image:"",description:"",listSong:[]},MyPlaylist:[],likeMusic:[]};let b=(()=>{class e extends m.m1{constructor(i,n,c,r,d){super(I),this.service=i,this.favoriteService=n,this.message=c,this.translateService=r,this.myPlaylistService=d,this.value$=this.select(a=>a.Album),this.myplaylist$=this.select(a=>a.MyPlaylist),this.listLikeSong$=this.select(a=>a.likeMusic),this.setIsLoadingDetail=this.updater((a,l)=>({...a,IsLoadingDetail:l})),this.loadAlbumDetail=this.effect(a=>a.pipe((0,h.b)(()=>this.patchState({IsLoadingDetail:!0})),(0,p.w)(l=>l?this.service.getAlbumDetail(l):(0,F.of)(void 0)),(0,m._b)(l=>{this.patchState({Album:l,IsLoadingDetail:!1})},l=>{this.patchState({Album:void 0,IsLoadingDetail:!1})}))),this.addSongToFavorite=this.effect(a=>a.pipe((0,p.w)(l=>this.favoriteService.addSongFavorite(l).pipe((0,m._b)(()=>{this.message.success(this.translateService.instant("MESSAGE.ADD_TO_FAVORITE")),this.loadSongFavorite()},y=>{this.message.error(y.error.message)}))))),this.getPlaylist=this.effect(a=>a.pipe((0,p.w)(()=>this.myPlaylistService.getAllMyPlayList().pipe((0,m._b)(l=>this.patchState({MyPlaylist:l}),l=>{this.message.error(l.error.message)}))))),this.addSongToPlaylist=this.effect(a=>a.pipe((0,h.b)(()=>this.patchState({})),(0,p.w)(([l,y])=>this.myPlaylistService.addSongToPlaylist(l,y).pipe((0,h.b)(()=>{this.patchState({})}),(0,m._b)(()=>{this.message.success(this.translateService.instant("MESSAGE.SUCCESS"))},j=>{this.message.error(j.error.message)}),(0,S.x)(()=>{this.patchState({})}))))),this.loadSongFavorite=this.effect(a=>a.pipe((0,h.b)(()=>{this.patchState({})}),(0,p.w)(()=>this.favoriteService.getSongFavoriteByUser().pipe((0,m._b)(l=>{this.patchState({likeMusic:l})},l=>{this.patchState({likeMusic:[]})}),(0,S.x)(()=>{this.patchState({})}))))),this.getPlaylist(),this.loadSongFavorite()}refreshData(){this.patchState({})}}return e.\u0275fac=function(i){return new(i||e)(t.LFG(L.$),t.LFG(T.e),t.LFG(A.dD),t.LFG(D.sK),t.LFG(C.e))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var P=s(9653),Z=s(812),$=s(9890),J=s(7698),G=s(275);function U(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div")(1,"app-playlist-track",6),t.NdJ("favorite",function(c){t.CHM(i);const r=t.oxw(4);return t.KtG(r.confirmFavorite(c))})("addMusicToPlaylist",function(c){t.CHM(i);const r=t.oxw(4);return t.KtG(r.addMusicToPlaylist(c))})("playMusic",function(c){t.CHM(i);const r=t.oxw(4);return t.KtG(r.playMusicItem(c))}),t.qZA()()}if(2&e){const i=o.ngIf,n=t.oxw(),c=n.index,r=n.$implicit,d=t.oxw(2).ngIf,a=t.oxw();t.xp6(1),t.Q6J("index",c)("song",r)("playlist",d)("playlistUser",i)("showFavorite",a.checkLikeMusic(r.id))}}function E(e,o){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,U,2,5,"div",0),t.ALo(2,"async"),t.qZA()),2&e){const i=t.oxw(3);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,i.myplaylist$))}}function O(e,o){if(1&e&&(t.TgZ(0,"div",4),t.YNc(1,E,3,3,"div",5),t.qZA()),2&e){const i=o.ngIf;t.xp6(1),t.Q6J("ngForOf",i)}}function Y(e,o){if(1&e){const i=t.EpF();t.TgZ(0,"div"),t._UZ(1,"app-detail",1),t.TgZ(2,"app-play-button",2),t.NdJ("click",function(){const r=t.CHM(i).ngIf,d=t.oxw();return t.KtG(d.playMusicList(r.listSong))}),t.qZA(),t._UZ(3,"app-title-list"),t.YNc(4,O,2,1,"div",3),t.qZA()}if(2&e){const i=o.ngIf;t.xp6(1),t.Q6J("imageUrl",i.image)("description",i.description)("title",i.name)("quantity",i.listSong.length),t.xp6(3),t.Q6J("ngIf",i.listSong)}}let M=(()=>{class e{constructor(i,n,c){this.albumDetailStore=i,this.route=n,this.store=c,this.id=String(this.route.snapshot.paramMap?.get("id")),this.albumDetail$=this.albumDetailStore.loadAlbumDetail(this.id),this.album$=this.albumDetailStore.value$,this.myplaylist$=this.albumDetailStore.myplaylist$,this.listLikeSong$=this.albumDetailStore.listLikeSong$,this.listLikeSong=[],this.listLikeSong$.pipe().subscribe(r=>this.listLikeSong=r)}ngOnInit(){}confirmFavorite(i){this.albumDetailStore.addSongToFavorite(i)}addMusicToPlaylist(i){this.albumDetailStore.addSongToPlaylist([this.id,i])}playMusicList(i){this.store.dispatch((0,g.Bn)({value:i})),this.store.dispatch((0,g.vZ)({value:i[0]}))}checkLikeMusic(i){return console.log(this.listLikeSong),!!this.listLikeSong?.map(n=>n.id).includes(i)}playMusicItem(i){this.store.dispatch((0,g.vZ)({value:i}))}}return e.\u0275fac=function(i){return new(i||e)(t.Y36(b),t.Y36(v.gz),t.Y36(P.yh))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-ablum-detail"]],decls:2,vars:3,consts:[[4,"ngIf"],["type","Album",3,"imageUrl","description","title","quantity"],[3,"click"],["class","items-center px-4 cursor-pointer h-14 hover:bg-white hover:bg-opacity-10",4,"ngIf"],[1,"items-center","px-4","cursor-pointer","h-14","hover:bg-white","hover:bg-opacity-10"],[4,"ngFor","ngForOf"],[3,"index","song","playlist","playlistUser","showFavorite","favorite","addMusicToPlaylist","playMusic"]],template:function(i,n){1&i&&(t.YNc(0,Y,5,5,"div",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,n.album$))},dependencies:[u.sg,u.O5,Z.J,$.F,J.x,G.H,u.Ov],styles:["[_nghost-%COMP%]{padding:1rem}"]}),e})();const z=[{path:"",component:M},{path:":id",component:M}];let _=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[v.Bz.forChild(z),v.Bz]}),e})();var B=s(3566),N=s(1855),Q=s(7500),k=s(8526),H=s(908),x=s(4006),K=s(6198);let R=(()=>{class e{}return e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[b],imports:[u.ez,_,B.j,N.S,Q.k,k.L,H.J,x.u5,x.UX,D.aw,A.gR,K.L]}),e})()}}]);