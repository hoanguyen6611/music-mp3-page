"use strict";(self.webpackChunkmusic_mp3_page=self.webpackChunkmusic_mp3_page||[]).push([[347],{6347:(X,S,e)=>{e.r(S),e.d(S,{SongDetailModule:()=>Q});var d=e(6895),v=e(9116),L=e(7579),T=e(2722),m=e(1293),t=e(4650),p=e(4280),g=e(8505),h=e(3900),y=e(8746),F=e(9646),C=e(2204),P=e(8689),f=e(9651),M=e(9383),I=e(5445);const A={IsLoadingDetail:!1,Value:{id:"",name:"",author:"",image:"",link:"",description:""},myPlaylist:[],likeMusic:[]};let D=(()=>{class s extends p.m1{constructor(i,o,l,r,V){super(A),this.service=i,this.favoriteService=o,this.message=l,this.translateService=r,this.myPlaylistService=V,this.value$=this.select(n=>n.Value),this.listLikeMusic$=this.select(n=>n.likeMusic),this.setIsLoadingDetail=this.updater((n,a)=>({...n,IsLoadingDetail:a})),this.loadSongDetail=this.effect(n=>n.pipe((0,g.b)(()=>this.patchState({IsLoadingDetail:!0})),(0,h.w)(a=>a?this.service.getSongByID(a):(0,F.of)(void 0)),(0,p._b)(a=>{this.patchState({Value:a,IsLoadingDetail:!1})},a=>{this.patchState({Value:void 0,IsLoadingDetail:!1})}))),this.addSongToFavorite=this.effect(n=>n.pipe((0,h.w)(a=>this.favoriteService.addSongFavorite(a).pipe((0,p._b)(()=>{this.loadSongFavorite(),this.message.success(this.translateService.instant("MESSAGE.ADD_TO_FAVORITE"))},u=>{this.message.error(u.error.message)}))))),this.getPlaylist=this.effect(n=>n.pipe((0,h.w)(()=>this.myPlaylistService.getAllMyPlayList().pipe((0,p._b)(a=>this.patchState({myPlaylist:a}),a=>{this.message.error(a.error.message)}))))),this.addSongToPlaylist=this.effect(n=>n.pipe((0,g.b)(()=>this.patchState(a=>({}))),(0,h.w)(([a,u])=>this.myPlaylistService.addSongToPlaylist(a,u).pipe((0,g.b)(()=>{this.patchState({})}),(0,p._b)(()=>{this.message.success(this.translateService.instant("MESSAGE.ADD_SONG_TO_PLAYLIST_SUCCESS"))},j=>{this.message.error(j.error.message)}),(0,y.x)(()=>{this.patchState({})}))))),this.loadSongFavorite=this.effect(n=>n.pipe((0,g.b)(()=>{this.patchState({})}),(0,h.w)(()=>this.favoriteService.getSongFavoriteByUser().pipe((0,p._b)(a=>{this.patchState({likeMusic:a})},a=>{this.patchState({likeMusic:[]})}),(0,y.x)(()=>{this.patchState({})}))))),this.getPlaylist(),this.loadSongFavorite()}refreshData(){this.patchState({})}}return s.\u0275fac=function(i){return new(i||s)(t.LFG(C.e),t.LFG(P.e),t.LFG(f.dD),t.LFG(M.sK),t.LFG(I.e))},s.\u0275prov=t.Yz7({token:s,factory:s.\u0275fac}),s})();var Z=e(9653),$=e(812),G=e(9890),J=e(7698),U=e(275);function E(s,c){if(1&s){const i=t.EpF();t.TgZ(0,"div")(1,"app-playlist-track",4),t.NdJ("favorite",function(l){t.CHM(i);const r=t.oxw(2);return t.KtG(r.addSongFavorite(l))})("addMusicToPlaylist",function(l){t.CHM(i);const r=t.oxw(2);return t.KtG(r.addMusicToPlaylist(l))})("playMusic",function(l){t.CHM(i);const r=t.oxw(2);return t.KtG(r.playMusicItem(l))}),t.qZA()()}if(2&s){const i=c.ngIf,o=t.oxw().ngIf,l=t.oxw();t.xp6(1),t.Q6J("index",0)("song",o)("playlist",o)("playlistUser",i)("showFavorite",l.checkLikeMusic(o.id))}}function O(s,c){if(1&s){const i=t.EpF();t.TgZ(0,"div"),t._UZ(1,"app-detail",1),t.TgZ(2,"app-play-button",2),t.NdJ("playMusic",function(l){t.CHM(i);const r=t.oxw();return t.KtG(r.playMusic(l))}),t.qZA(),t._UZ(3,"app-title-list"),t.TgZ(4,"div",3),t.YNc(5,E,2,5,"div",0),t.ALo(6,"async"),t.qZA()()}if(2&s){const i=c.ngIf,o=t.oxw();t.xp6(1),t.Q6J("imageUrl",i.image)("description",i.description)("title",i.name)("quantity",1),t.xp6(1),t.Q6J("song",i),t.xp6(3),t.Q6J("ngIf",t.lcZ(6,6,o.myplaylist$))}}let x=(()=>{class s{constructor(i,o,l){this.songDetailStore=i,this.route=o,this.store=l,this.destroy$=new L.x,this.item=String(this.route.snapshot.paramMap?.get("id")),this.songDetail$=this.songDetailStore.loadSongDetail(this.item),this.song$=this.songDetailStore.value$,this.myplaylist$=this.songDetailStore.select(r=>r.myPlaylist),this.listLikeMusic$=this.songDetailStore.listLikeMusic$,this.listLikeMusic=[],console.log(this.checkLikeMusic("bb9b3728-be0a-4f5f-8488-ad543620547c")),this.listLikeMusic$.pipe((0,T.R)(this.destroy$)).subscribe(r=>this.listLikeMusic=r)}ngOnInit(){}addMusicToPlaylist(i){this.songDetailStore.addSongToPlaylist([this.item,i])}addSongFavorite(i){this.songDetailStore.addSongToFavorite(i)}playMusic(i){this.store.dispatch((0,m.vZ)({value:i}))}playMusicItem(i){this.store.dispatch((0,m.vZ)({value:i}))}checkLikeMusic(i){return!!this.listLikeMusic?.map(o=>o.id).includes(i)}}return s.\u0275fac=function(i){return new(i||s)(t.Y36(D),t.Y36(v.gz),t.Y36(Z.yh))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-song-detail"]],decls:2,vars:3,consts:[[4,"ngIf"],["type","Artist",3,"imageUrl","description","title","quantity"],[3,"song","playMusic"],[1,"items-center","px-4","cursor-pointer","h-14","hover:bg-white","hover:bg-opacity-10"],[3,"index","song","playlist","playlistUser","showFavorite","favorite","addMusicToPlaylist","playMusic"]],template:function(i,o){1&i&&(t.YNc(0,O,7,8,"div",0),t.ALo(1,"async")),2&i&&t.Q6J("ngIf",t.lcZ(1,1,o.song$))},dependencies:[d.O5,$.J,G.F,J.x,U.H,d.Ov],styles:["[_nghost-%COMP%]{padding:1rem}"]}),s})();const z=[{path:"",component:x},{path:":id",component:x}];let Y=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[v.Bz.forChild(z),v.Bz]}),s})();var B=e(3566),R=e(1855),k=e(8526),H=e(908),K=e(3178),N=e(6198);let Q=(()=>{class s{}return s.\u0275fac=function(i){return new(i||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({providers:[D,K.k],imports:[d.ez,Y,B.j,R.S,k.L,H.J,M.aw,f.gR,N.L]}),s})()}}]);